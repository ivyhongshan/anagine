"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _authMiddleware = _interopRequireDefault(require("./authMiddleware"));
var _tierAccessMiddleware = _interopRequireDefault(require("./tierAccessMiddleware"));
var _perIndexTierAccessMiddleware = _interopRequireDefault(require("./perIndexTierAccessMiddleware"));
var _config = _interopRequireDefault(require("../config"));
var _logger = _interopRequireDefault(require("../logger"));function _interopRequireDefault(e) {return e && e.__esModule ? e : { default: e };}

const middlewares = [];

// If a universal tierAccessLevel has not been applied in the manifest,
// we apply ES-index-specific tiered access settings.
switch (_config.default.tierAccessLevel) {
  case 'libre':
    _logger.default.info('[Server] applying libre middleware across indices.');
    break;
  case 'regular':
    _logger.default.info('[Server] applying regular middleware across indices.');
    middlewares.push(_tierAccessMiddleware.default);
    break;
  case 'private':
    _logger.default.info('[Server] applying private middleware across indices.');
    middlewares.push(_authMiddleware.default);
    break;
  default:
    _logger.default.info('[Server] applying index-scoped middleware.');
    middlewares.push(_perIndexTierAccessMiddleware.default);
    break;
}var _default = exports.default =
middlewares;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXV0aE1pZGRsZXdhcmUiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl90aWVyQWNjZXNzTWlkZGxld2FyZSIsIl9wZXJJbmRleFRpZXJBY2Nlc3NNaWRkbGV3YXJlIiwiX2NvbmZpZyIsIl9sb2dnZXIiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJtaWRkbGV3YXJlcyIsImNvbmZpZyIsInRpZXJBY2Nlc3NMZXZlbCIsImxvZyIsImluZm8iLCJwdXNoIiwidGllckFjY2Vzc01pZGRsZXdhcmUiLCJhdXRoTWlkZGxld2FyZSIsInBlckluZGV4VGllckFjY2Vzc01pZGRsZXdhcmUiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvc2VydmVyL21pZGRsZXdhcmVzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhdXRoTWlkZGxld2FyZSBmcm9tICcuL2F1dGhNaWRkbGV3YXJlJztcbmltcG9ydCB0aWVyQWNjZXNzTWlkZGxld2FyZSBmcm9tICcuL3RpZXJBY2Nlc3NNaWRkbGV3YXJlJztcbmltcG9ydCBwZXJJbmRleFRpZXJBY2Nlc3NNaWRkbGV3YXJlIGZyb20gJy4vcGVySW5kZXhUaWVyQWNjZXNzTWlkZGxld2FyZSc7XG5pbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZyc7XG5pbXBvcnQgbG9nIGZyb20gJy4uL2xvZ2dlcic7XG5cbmNvbnN0IG1pZGRsZXdhcmVzID0gW107XG5cbi8vIElmIGEgdW5pdmVyc2FsIHRpZXJBY2Nlc3NMZXZlbCBoYXMgbm90IGJlZW4gYXBwbGllZCBpbiB0aGUgbWFuaWZlc3QsXG4vLyB3ZSBhcHBseSBFUy1pbmRleC1zcGVjaWZpYyB0aWVyZWQgYWNjZXNzIHNldHRpbmdzLlxuc3dpdGNoIChjb25maWcudGllckFjY2Vzc0xldmVsKSB7XG4gIGNhc2UgJ2xpYnJlJzpcbiAgICBsb2cuaW5mbygnW1NlcnZlcl0gYXBwbHlpbmcgbGlicmUgbWlkZGxld2FyZSBhY3Jvc3MgaW5kaWNlcy4nKTtcbiAgICBicmVhaztcbiAgY2FzZSAncmVndWxhcic6XG4gICAgbG9nLmluZm8oJ1tTZXJ2ZXJdIGFwcGx5aW5nIHJlZ3VsYXIgbWlkZGxld2FyZSBhY3Jvc3MgaW5kaWNlcy4nKTtcbiAgICBtaWRkbGV3YXJlcy5wdXNoKHRpZXJBY2Nlc3NNaWRkbGV3YXJlKTtcbiAgICBicmVhaztcbiAgY2FzZSAncHJpdmF0ZSc6XG4gICAgbG9nLmluZm8oJ1tTZXJ2ZXJdIGFwcGx5aW5nIHByaXZhdGUgbWlkZGxld2FyZSBhY3Jvc3MgaW5kaWNlcy4nKTtcbiAgICBtaWRkbGV3YXJlcy5wdXNoKGF1dGhNaWRkbGV3YXJlKTtcbiAgICBicmVhaztcbiAgZGVmYXVsdDpcbiAgICBsb2cuaW5mbygnW1NlcnZlcl0gYXBwbHlpbmcgaW5kZXgtc2NvcGVkIG1pZGRsZXdhcmUuJyk7XG4gICAgbWlkZGxld2FyZXMucHVzaChwZXJJbmRleFRpZXJBY2Nlc3NNaWRkbGV3YXJlKTtcbiAgICBicmVhaztcbn1cbmV4cG9ydCBkZWZhdWx0IG1pZGRsZXdhcmVzO1xuIl0sIm1hcHBpbmdzIjoib0dBQUEsSUFBQUEsZUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMscUJBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLDZCQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUEsZUFBNEIsU0FBQUQsdUJBQUFNLENBQUEsVUFBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7O0FBRTVCLE1BQU1HLFdBQVcsR0FBRyxFQUFFOztBQUV0QjtBQUNBO0FBQ0EsUUFBUUMsZUFBTSxDQUFDQyxlQUFlO0VBQzVCLEtBQUssT0FBTztJQUNWQyxlQUFHLENBQUNDLElBQUksQ0FBQyxvREFBb0QsQ0FBQztJQUM5RDtFQUNGLEtBQUssU0FBUztJQUNaRCxlQUFHLENBQUNDLElBQUksQ0FBQyxzREFBc0QsQ0FBQztJQUNoRUosV0FBVyxDQUFDSyxJQUFJLENBQUNDLDZCQUFvQixDQUFDO0lBQ3RDO0VBQ0YsS0FBSyxTQUFTO0lBQ1pILGVBQUcsQ0FBQ0MsSUFBSSxDQUFDLHNEQUFzRCxDQUFDO0lBQ2hFSixXQUFXLENBQUNLLElBQUksQ0FBQ0UsdUJBQWMsQ0FBQztJQUNoQztFQUNGO0lBQ0VKLGVBQUcsQ0FBQ0MsSUFBSSxDQUFDLDRDQUE0QyxDQUFDO0lBQ3RESixXQUFXLENBQUNLLElBQUksQ0FBQ0cscUNBQTRCLENBQUM7SUFDOUM7QUFDSixDQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBWCxPQUFBO0FBQ2NDLFdBQVciLCJpZ25vcmVMaXN0IjpbXX0=